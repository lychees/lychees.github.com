<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="default">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />




  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico?v=5.1.3">















<meta name="description" content="Valar Morghulis">
<meta property="og:type" content="website">
<meta property="og:title" content="AFAIK">
<meta property="og:url" content="roosephu.github.io/page/8/index.html">
<meta property="og:site_name" content="AFAIK">
<meta property="og:description" content="Valar Morghulis">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AFAIK">
<meta name="twitter:description" content="Valar Morghulis">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="roosephu.github.io/page/8/"/>





  <title>AFAIK</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37094989-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AFAIK</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Valar Dohaeris</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/04/08/UyHiP-2011-Mar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/04/08/UyHiP-2011-Mar/" itemprop="url">UyHiP-2011-Mar</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-04-08T12:00:00+08:00">
                2013-04-08
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/04/08/UyHiP-2011-Mar/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/04/08/UyHiP-2011-Mar/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>UyHiP 的题目感觉很杂，相对来说 TOAD 就好玩多了嘛。</p>
<!-- 今天的这个题和 TOAD-puzzle-35 很像，两者应该有类似解法的。 -->
<h1 id="problem">problem</h1>
<p>给定一个无向图，点有黑白两种颜色。每次你可以选择一个点，并把这个点以及所有和它相邻的点的颜色取反。初始时所有点的颜色是白色。</p>
<p>是否能在有限步内把所有的点全部变成黑色？</p>
<p><a href="http://www.brand.site.co.il/riddles/201103q.html" target="_blank" rel="noopener">原题链接如下</a></p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br></p>
<h1 id="solution">solution</h1>
<p>可以证明一定是可行的。</p>
<h2 id="基于构造的证明">基于构造的证明</h2>
<p>数学归纳法。对点数 <span class="math inline">\(n\)</span> 进行归纳。</p>
<p>当 <span class="math inline">\(n = 1\)</span> 时显然。</p>
<p>假设 <span class="math inline">\(n\)</span> 时成立，我们要证明 <span class="math inline">\(n + 1\)</span> 也成立。我们在其中选任意 <span class="math inline">\(n\)</span> 个点。由假设知，对于这 <span class="math inline">\(n\)</span> 个点存在一个方案使得全部变为黑色。如果这个方案顺便把没被选中的点变为黑色，则找到一组解了。否则我们可以取反任意 <span class="math inline">\(n\)</span> 个点的颜色。</p>
<p>如果 <span class="math inline">\(n\)</span> 为偶数，我们对于任意 <span class="math inline">\(n\)</span> 个点均反色一次，可以知道每个点被反色了 <span class="math inline">\(n - 1\)</span> 次为奇数，即现在每个点都是黑色。</p>
<p>如果 <span class="math inline">\(n\)</span> 为奇数，易知必定有一个点的度数为偶数（奇数个点，度数和为偶数），我们一开始对于这个点操作一次，则现在还剩下偶数个点是白色的。对于这偶数个点，我们可以使用与 <span class="math inline">\(n\)</span> 为偶数时类似的方法，每个点都有一次不被取反的机会。所以操作后所有点都是黑色的。</p>
<h2 id="基于线代的证明">基于线代的证明</h2>
<p>看到线代我就吓尿了。但是看完解法我觉得好简单 →_→</p>
<p>考虑证明高斯消元（ over GF2 ）是有解的。我们把原图的邻接矩阵加单位矩阵记为 <span class="math inline">\(M\)</span> ，用 <span class="math inline">\(Diag(M)\)</span> 表示矩阵 <span class="math inline">\(M\)</span> 的对角线。我们要证明的是，若 <span class="math inline">\(M = M^T\)</span> （即对称），则 <span class="math inline">\(xM = Diag(M)\)</span> 一定存在解。</p>
<p>无解的充要条件是存在一个向量 <span class="math inline">\(v\)</span> 使得 <span class="math inline">\(v^T M = 0\)</span> 而 <span class="math inline">\(v^T Diag(M) = 1\)</span> 。但是，我们有</p>
<p><span class="math display">\[ 0 = v^T M v
  = v^T (L + D + U) v
  = v^T L v + v^T D v + v^T U v
  = v^T L v + v^T D v + (v^T L v)^T
  = v^T L v + v^T D v + v^T L v
  = v^T D v
  = v^T Diag(M)\]</span></p>
<p><span class="math inline">\(L, D, U\)</span> 分别是 <span class="math inline">\(M\)</span> 的下三角、对角矩阵、上三角。所以我们知道这种情况是不可能的，原方程必定有解。</p>
<h1 id="nonsense">nonsense</h1>
<p>看维基百科果然是 dfs 。</p>
<p>我就想查查线性代数的东西结果居然查到 <span class="math inline">\(e^{\pi}\)</span> 去了 →_→</p>
<p>blahtex 居然不支持 array 。似乎它自己写了个后端。于是重新搞了个后端。网上下载了一个 tex2png ，发现居然是 bash 写的真是太好了。改了改就可以用了。模仿 blahtex 给 Maruku 写了个后端，感觉蛮简单的。但是 tex2png 的 png 输出惨不忍睹，主要是 dvipng 的调用参数写抽了，所以就下载了 blahtex 的源代码看看它是怎么调用 dvipng 的。 总之差不太多啦。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/04/07/TOAD-20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/04/07/TOAD-20/" itemprop="url">TOAD-puzzle-20</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-04-07T12:00:00+08:00">
                2013-04-07
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/04/07/TOAD-20/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/04/07/TOAD-20/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这个题目似乎比较简单。</p>
<h1 id="problem">problem</h1>
<p>某国有 2kw 选民，国王的支持者只占 1% 。现在有一种“民主”的选举方式：我们将全部的选民分为 <span class="math inline">\(n_1\)</span> 组（每组选民数目相同），每组内的选民再分为 <span class="math inline">\(n_2\)</span> 组（仍然要求选民数目相同），再这样分下去，直至只剩一个人。每一组的投票结果为这一组分成的若干个小组的投票结果中，出现次数最多的候选人。如果有多个相同的，我们假定国王会输。</p>
<p>是否存在一种分组方式，使得国王通过一定的分配方案使得他获得整个选举的胜利？</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br></p>
<h1 id="solution">solution</h1>
<p>浪费可耻，于是国王的最优策略肯定是：要么不派人，一旦派人则这个人要一直是多数。</p>
<p>由于要求国王赢的话出现次数必须严格超过一半。假设我们把一堆人分成 <span class="math inline">\(2k - 1\)</span> 组，则我们只需争取 <span class="math inline">\(k\)</span> 组的胜利即可。在这个过程中，我们需要的人数可以减小到总人数的 <span class="math inline">\(\frac{k}{2k - 1}\)</span> 。</p>
<p>由于 2kw 分解后 5 的指数为 7 ，所以我们可以分 7 次，每次分成 5 组。在所有的 <span class="math inline">\(5^7\)</span> 组中，我们只需赢得 <span class="math inline">\(3^7\)</span> 组胜利即可，这组数只占全部的 2.79936% ，离 1% 还差了一点。</p>
<p>注意到现在每组还有 256 个人，我们可以通过一定的分组方式再减小人数。如果只分成 1 组，需要 1.410615% 的人口；考虑分成 16 组，每组的 16 个人中派 9 个人，则只需要 0.885735% 的人口，小于 1% 了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/04/07/TC-575/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/04/07/TC-575/" itemprop="url">Topcoder-575</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-04-07T12:00:00+08:00">
                2013-04-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Topcoder/" itemprop="url" rel="index">
                    <span itemprop="name">Topcoder</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/04/07/TC-575/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/04/07/TC-575/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>少了个特判被 cha 好桑心……</p>
<p>1k 原题什么情况！我勒个去。</p>
<h1 id="solution">solution</h1>
<h2 id="pts">250 pts</h2>
<p>结论： <span class="math inline">\(n\)</span> 为奇数是先手必败。若 <span class="math inline">\(n = 2^k\)</span> 则 <span class="math inline">\(k\)</span> 奇先手必败 <span class="math inline">\(k\)</span> 偶先手必胜，否则先手必胜。</p>
<del>
证明的话 7k+ 说看 Rudin 的书。（可是我记忆中 Rudin 的书是关于高数的？）
</del>
<p>证明的话还是归纳吧。不打表我真就不会做。</p>
<p>果然我被坑能力拔群。轻轻松松被 7k+ 坑 →_→</p>
<p>我提问发自真心。</p>
<h2 id="pts-1">500 pts</h2>
<p>显然，对于一个元素来说，如果它不在一开始的位置，则在其他任何位置的概率是相同的。</p>
<p>于是我们可以递推出 <span class="math inline">\(k\)</span> 次操作后，每个元素在初始位置的概率。不妨设 <span class="math inline">\(f_i\)</span> 表示 <span class="math inline">\(i\)</span> 次操作后的概率，可以得到递推式：</p>
<p><span class="math display">\[f_{i+1} = \frac{n-2}{n} f_i + \frac{2}{n} \frac{1}{n-1} (1-f_i)\]</span></p>
<p>前一半表示一开始就在这个位置的概率，后一半表示交换回来的概率。</p>
<p>如何计算答案？我们计算每个元素对答案的贡献。枚举每个元素，再枚举最后的位置 <span class="math inline">\(x\)</span> ，则对答案做出的贡献是在这个位置的概率乘上这个数的值再乘上这个位置被子序列包含的概率。</p>
<h2 id="pts-2">1000 pts</h2>
<p>原题什么的，我就只能说自己做题太少了。<del>没坑好神奇</del></p>
<p>以下是 xiaodao （蒯）的方法，我觉得非常漂亮。</p>
<p>大家见过的构图大部分是 <code>S -&gt; x -&gt; y -&gt; T</code> 这种图吧。这次的构图是 <code>S -&gt; x -&gt; y -&gt; x -&gt; T</code> 好奇葩。</p>
<p>我们把白点按照列数的奇偶分成两种白点。则黑点每次在两种白点中要各取一个。于是前一个 <code>x</code> 表示的是第一种白点，后一个 <code>x</code> 表示的第二种白点，中间的 <code>y</code> 表示黑点。为了保证一个黑点只会被流一次，我们需要将 <code>y</code> 再拆点，流量上限 1 。</p>
<p>这种建图的关键是每一个 L 形被一条增广路所表示，利用白点列数的奇偶性非常巧妙。写起来非常好写～（有 SAP 模板就是爽）</p>
<h1 id="situation">situation</h1>
<p>首先看完 250 ，发现不会做。以前见过一个除法的，特水，分解质因数即可。减法的还真就不知道怎么做。</p>
<p>看了一下样例，感觉没啥思路。而且 <span class="math inline">\(n\)</span> 的范围是 <span class="math inline">\(10^{18}\)</span> ，普通分解方式还应付不了，所以不会是质因数分解这方面。决定赶紧写程序打表。表倒是好打，发现奇偶性很有规律的样子，于是把必胜/必败与 <span class="math inline">\(n\)</span> 的奇偶性无关的提出来，发现一定是 2 的幂。然后就好了。</p>
<p>怒开 500 。看完第一段感觉很开心的样子，想到了 CF 某题，那个题是动态维护每个点最后在某个位置的概率。继续看下去发现有个啥还有个期望子段和，感觉就是这样了。再一想发现没具体给定交换，那么动态维护的矩阵一堆相同的数，不同的数只有 2 个 →_→ ……稍微推了下发现是可行的。怒写代码，430+ 分好爽。</p>
<p>然后开了 1000 pts 的，想了一下觉得没啥好做的，于是就坑了 →_→</p>
<p>Challenge 的时候发现 250 pts 的被 Cha 了，原因是忘记判 1 这个特殊条件了 T_T</p>
<p>幸亏过了 500 pts 否则就爆零了。</p>
<p>最后 #136 ，由于是小号还是可以涨的。只涨了 52 。<del>（下次可以涨红吧？）</del> 不要立 flag ！</p>
<h1 id="others">others</h1>
<p>Petr #1 rejudge #2 meret #3</p>
<p>wuzhengkai #15 。250 居然 FST 真是无语。</p>
<p>ChnLich #18 和我一样第一题被 cha 。</p>
<p>xiaodao #20 rating 和我一样了。上次 Seter 给 xiaodao 跌了蛮多的。</p>
<p>tourist #21 因为 1000 pts FST 了。</p>
<p>7k+ 居然用大号！cha 人 cha 的丧心病狂。#23</p>
<p>scottai #71 过前俩题正常节奏。</p>
<p>liouzhou_101 的 500 pts 只有 200+ 分，所以他俩题加起来没我一题多…… #143</p>
<p>秋锅第一题看错题了光荣爆零。</p>
<p>耀爷一开始说他不想做了，于是硬把他拉过来做……不过考到一半没网了好惨 →_→</p>
<h1 id="nonsense">nonsense</h1>
<p>祝大家 CTSC 好运。</p>
<p>不能太颓废了，得开学习模式了呢。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/04/06/TOAD-37/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/04/06/TOAD-37/" itemprop="url">TOAD-puzzle-37</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-04-06T12:00:00+08:00">
                2013-04-06
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/04/06/TOAD-37/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/04/06/TOAD-37/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>似乎 Matrix67 大大已经翻译过了。</p>
<h1 id="problem">problem</h1>
<p>一个长度为 <span class="math inline">\(n\)</span> 的 0/1 串，A/B 俩人博弈。每次操作如下：</p>
<ol type="1">
<li>如果当前串首是 1 ，则放一个 0/1 到串尾，由 A 决定</li>
<li>如果当前串首是 0 ，则放一个 0/1 到串尾，由 B 决定</li>
<li>删除串首，重复以上过程</li>
</ol>
<p>如果有限步内这个串全是 0 ，则 A 获胜，否则 B 获胜。</p>
<p>问什么情况下 A 必胜。</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br></p>
<h1 id="solution">solution</h1>
<p>任一情况下 A 都必胜。</p>
<p>A 的方案如下：我们把整个串看成是一个大的二进制数。我们称连续操作 <span class="math inline">\(n\)</span> 次为一轮操作。如果我们保证任意一轮操作后，二进制数一定会增加，那么总有一轮过后整个串会全是 1 。这个时候全部都是 A 操作，全部设为 0 即可。</p>
<p>如何保证二进制数一定会增加呢？A 的策略为，在这一轮中，如果 B 已经将一个 0 变为 1 了，则保持这个 1 不变，否则把 1 变为 0 。显然，B 至少将一个 0 变为 1 ，否则 A 就赢了。只要 B 将一个 0 变为 1，则整个串的二进制数一定会增加。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/04/05/TOAD-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/04/05/TOAD-2/" itemprop="url">TOAD-puzzle-2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-04-05T12:00:00+08:00">
                2013-04-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/04/05/TOAD-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/04/05/TOAD-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>呼啦啦准备翻译完 TOAD 。这些题真心虐心啊……</p>
<p>今天说的这个题有一个众所周知的方法。但是还有一个非常漂亮的解法，我相信还是没多少人见过的。</p>
<h1 id="problem">problem</h1>
<p>有 <span class="math inline">\(n\)</span> 个人坐在一张圆形桌子前，每个人面前有一盏灯。现在 A 和 B 博弈。流程如下：</p>
<ol type="1">
<li>A 选择若干个位置，并把选择的结果告诉 B</li>
<li>B 把桌子转一下</li>
<li>把 A 选择的位置的灯的状态同时取反</li>
<li>重复以上过程</li>
</ol>
<p>游戏终止的条件是存在某一时刻，使得所有的灯都是亮的。游戏终止则 A 获胜，否则 B 获胜。</p>
<p>A 随时可以调整策略，即 A 每次决策的时候可以看到现在灯的状态，并做出反应。</p>
<p>问：什么情况下 A 可以获胜。</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br></p>
<h1 id="solution">solution</h1>
<p>结论：当 <span class="math inline">\(n\)</span> 为 2 的整数次幂或者初始局面灯的状态全部相同时 A 可以获胜，否则 B 一定获胜。</p>
<p>第二种情况的证明是显然的，我们主要讨论第一种情况的证明。</p>
<h2 id="第一种方法">第一种方法</h2>
<p>用数学归纳法。</p>
<p><span class="math inline">\(n = 1\)</span> 时，显然。如果初始是亮的就赢了否则把它的状态取反即可。</p>
<p>如果 <span class="math inline">\(n = 2^k\)</span> 时具有获胜策略，我们要证明 <span class="math inline">\(2n\)</span> 个人也一定有必胜策略。</p>
<p>我们把灯一次编号为 <span class="math inline">\(1, 2, \dots, 2n\)</span> ，并把这 <span class="math inline">\(2n\)</span> 盏灯分成 <span class="math inline">\(n\)</span> 组： <span class="math inline">\(i\)</span> 和 <span class="math inline">\(i + n\)</span> 分为一组。</p>
<p>我们把每一组看成是一盏超级灯。我们现在定义超级灯是亮的，当且仅当这一组的两盏灯的明灭状态相同。现在我们有 <span class="math inline">\(n\)</span> 盏超级灯，每一次我们可以改变若干盏超级灯的状态，因为改变一盏超级灯的状态只需要改变这一组内任意一盏灯的状态即可。由于对于 <span class="math inline">\(n\)</span> 盏灯我们有必胜策略，因此我们总可以把这 <span class="math inline">\(n\)</span> 盏超级灯的状态变为全亮。</p>
<p>现在这 <span class="math inline">\(n\)</span> 盏超级灯的状态全亮了，但是可能有若干盏超级灯代表的两盏灯都是灭的。我们重新定义超级灯是亮的，当且仅当这两盏灯都是亮的。每一次改变超级灯状态的时候，我们总是会把这两盏灯的状态同时改变，因此这两盏灯的状态总是相同的。我们再次利用 <span class="math inline">\(n\)</span> 时的必胜策略即可。</p>
<h2 id="第二种方法">第二种方法</h2>
<p>这种方法听起来很不可思议，但是它确实是可行的……</p>
<p>现在要求灯是全亮的。我们不妨要求灯全灭，最后再一次操作把所有灯反过来就好了。于是 A 的目标是把所有灯灭掉。A 的策略很简单：每次选定当前亮着的所有的灯。</p>
<p>我们来证明这是可行的。定义一个多项式 <span class="math inline">\(b(x) = a_0 x^0 + a_1 x^1 + \dots + a_{n - 1} x^{n - 1}\)</span> ，其中 <span class="math inline">\(a_i\)</span> 表示第 <span class="math inline">\(i + 1\)</span> 盏灯的明灭状态。我们不妨设这一次 B 选择把桌子顺时针旋转 <span class="math inline">\(j\)</span> 个位置，那么这次操作相当于给多项式 <span class="math inline">\(b(x)\)</span> 乘上一个 <span class="math inline">\(1 + x^j\)</span> 。（把所有的操作看成是在 <span class="math inline">\(GF_2\)</span> 下的吧）</p>
<p>经过 <span class="math inline">\(m\)</span> 次操作后，现在的多项式为</p>
<p><span class="math display">\[t(x) = b(x) \prod_{i = 1}^m (1 + x^{j_i})\]</span></p>
<p>当 <span class="math inline">\(m \geq n(n - 1) + 1\)</span> 时，我们知道至少有 <span class="math inline">\(n\)</span> 次操作，这 <span class="math inline">\(n\)</span> 次操作选择的 <span class="math inline">\(j\)</span> 是相同的。</p>
<p>对于任意一个 <span class="math inline">\(j\)</span> ，在 <span class="math inline">\(GF_2\)</span> 内我们有</p>
<p><span class="math display">\[(1+x^j)^2 = 1 + 2 x^j + x^{2j} = 1 + x^{2j}\]</span></p>
<p>由于 <span class="math inline">\(n\)</span> 是 2 的整数次幂，于是</p>
<p><span class="math display">\[(1+x^j)^n = 1 + x^{nj} = 1 + x^0 = 0\]</span></p>
<p>所以 <span class="math inline">\(t(x)\)</span> 一定为 0 ，表示所有的灯都灭了。</p>
<h2 id="无解">无解</h2>
<p>考虑 <span class="math inline">\(n\)</span> 为大于 1 的奇数的情况。如果初始状态不是全部相同，则一定有两盏相邻的灯它们的状态不相同。我们保证任意时刻这两盏灯的状态均不相同即可。</p>
<p>对于 A 的每次操作，由于 <span class="math inline">\(n\)</span> 是奇数，因此必定存在相邻两个位置，对这两个位置的操作是相同的。B 只需转一转，把这两个位置与两盏灯对应起来即可。</p>
<p>延伸一下，对于 <span class="math inline">\(n = 2^a * b\)</span> 其中 <span class="math inline">\(b\)</span> 为大于 1 的奇数，那么我们把这 <span class="math inline">\(n\)</span> 盏灯分为 <span class="math inline">\(2^m\)</span> 组，每组 <span class="math inline">\(b\)</span> 个。保证一组内整个游戏就肯定无解。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/04/04/TOAD-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/04/04/TOAD-5/" itemprop="url">TOAD-puzzle-5</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-04-04T12:00:00+08:00">
                2013-04-04
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/04/04/TOAD-5/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/04/04/TOAD-5/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>新生活。</p>
<p>看到一个很好玩的题，来源于 TOAD 。</p>
<h1 id="problem">problem</h1>
<p>给定一个正整数三元组 <span class="math inline">\((a, b, c)\)</span> ，每次可以选择任意两个数，不妨假设选择 <span class="math inline">\(a, b\)</span> ，且满足 <span class="math inline">\(a \leq b\)</span> ，则可以把这个三元组变换到 <span class="math inline">\((2a, b - a, c)\)</span> 。</p>
<p>求证：任意一个三元组经过若干次变换后，总可以使一个数为 0 。</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br></p>
<h1 id="solution">solution</h1>
<p>三个数的奇偶性只有 4 种情况，分类讨论。</p>
<ol type="1">
<li>奇奇奇。任意变换一次后转为奇偶偶。</li>
<li>奇奇偶。选两个奇数变换后转为偶偶偶。</li>
<li>偶偶偶。可知任意变换均不会改变奇偶性，全部除二。</li>
<li>奇偶偶。解决这种情况即可。</li>
</ol>
<p>我们先考虑一个奇数与一个偶数组成的二元组。可以知道，任意一个二元组的变换方式是唯一的。对于二元组 <span class="math inline">\((a, b)\)</span> （保证 <span class="math inline">\(a\)</span> 为偶数 <span class="math inline">\(b\)</span> 为奇数），若另一个二元组 <span class="math inline">\((a&#39;, b&#39;)\)</span> 变换到 <span class="math inline">\((a, b)\)</span> ，则可以知道 <span class="math inline">\((a&#39;, b&#39;)\)</span> 是唯一的，为 <span class="math inline">\((a + \frac{b}{2}, \frac{b}{2})\)</span> 。即，每个二元组都可以由一个二元组变换过来，且一定可以变换到一个二元组去。这表示从一个二元组开始变换，最后一定可以回到这个二元组。显然，经过有限次变换后 <span class="math inline">\((a, b)\)</span> 一定可以变成它的前驱，也就是 <span class="math inline">\((a + \frac{b}{2}, \frac{b}{2})\)</span> 。在这个过程中，奇数会增加，偶数会除以二。</p>
<p>考虑三个数 <span class="math inline">\((a, b, c)\)</span> ，奇偶性分别是奇偶偶。如果 <span class="math inline">\(b\)</span> 和 <span class="math inline">\(c\)</span> 模 4 同时为 2 ，变换 <span class="math inline">\(b\)</span> 和 <span class="math inline">\(c\)</span> 一次后两个数模 4 一定为 0 。如果不同时为 2 ，则必定有一个模 4 为 0 ，利用刚才讲到的方法可以让这个数除以二。有限次后， <span class="math inline">\(b\)</span> 和 <span class="math inline">\(c\)</span> 一定都会变成 1 ，然后再做一次变换就会有个数变成 0 了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/04/02/CF-177/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/04/02/CF-177/" itemprop="url">Codeforces-177</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-04-02T12:00:00+08:00">
                2013-04-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Codeforces/" itemprop="url" rel="index">
                    <span itemprop="name">Codeforces</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/04/02/CF-177/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/04/02/CF-177/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一次多好的进前五的机会啊，居然被浪费了。</p>
<p>最近 FST 特别多，这状态怎么搞腾讯的比赛咯。</p>
<p>最后 #39 不算很坏的结果，但起码 E FST 了很桑心。</p>
<h1 id="solution">solution</h1>
<h2 id="a">A</h2>
<p>先把整个序列用 ab 染好，最后 <span class="math inline">\(k - 2\)</span> 个从 c 开始赋。</p>
<p>当然，搜索也是可以的。</p>
<h2 id="b">B</h2>
<p>可以发现前 <span class="math inline">\(k\)</span> 个与后 <span class="math inline">\(n - k\)</span> 个是无关的。由于 <span class="math inline">\(k\)</span> 特别小，直接搜索 <span class="math inline">\(2 - k\)</span> 个值即可。复杂度 <span class="math inline">\(O(k^k)\)</span> 。</p>
<h2 id="c">C</h2>
<p>不妨考虑 <span class="math inline">\(p_n\)</span> 应该是多少。令 <span class="math inline">\(x\)</span> 表示最小的不小于 <span class="math inline">\(n\)</span> 的能表示成 <span class="math inline">\(2^k - 1\)</span> 的形式的数，则 <span class="math inline">\(p_n\)</span> 的最优解显然就是 <span class="math inline">\(x ^ k\)</span> 。继续考虑下去，可以发现对于 <span class="math inline">\([x^n, n]\)</span> 内的每个数我们都可以找到唯一的对应关系。剩下的数递归就好。</p>
<h2 id="d">D</h2>
<p>不妨设为有根树。考虑枚举 <span class="math inline">\(a\)</span> 到 <span class="math inline">\(b\)</span> 这条路径的 LCA <span class="math inline">\(t\)</span>。我们要从 <span class="math inline">\(t\)</span> 的子树中选出两个点，使得它们的 LCA 是 <span class="math inline">\(t\)</span> 。这样的方案数是有 <span class="math inline">\({size_t \choose 2} - \sum_{x \textrm{is a child}} {size_x \choose 2}\)</span> 。 <span class="math inline">\(t\)</span> 的子树外我们任取两个点即可，方案数为 <span class="math inline">\({n - size_t \choose 2}\)</span> 。考虑到如果两条路径分布在不同的子树，这种情况我们会计算两遍，所以我们还要把这种情况剪掉。然后就没了。</p>
<h2 id="e">E</h2>
<p>一个显然的数位 dp 。我们预处理两个值 <span class="math inline">\(f_i, g_i\)</span> ，分别表示所有的 <span class="math inline">\(i\)</span> 位幸运数相邻两个的积的和以及所有 <span class="math inline">\(i\)</span> 位幸运数相邻两个的和的和。于是我们有如下递推式：</p>
<p><span class="math display">\[f_{i + 1} = 2 f_i + 65 * 100^i * (2^i - 1) + 11 * 10^i * g_i + (\frac{10^i - 1}{9} * 7 + 4 * 10^i) * (\frac{10^i - 1}{9} * 4 + 7 * 10^i)\]</span> <span class="math display">\[g_{i + 1} = 2 g_i + 22 * 10^i * (2^i - 1) + 11 * \frac{10^{i + 1} - 1}{9}\]</span></p>
<p><span class="math inline">\(f\)</span> 的递推式可以这么想：任意三个数 <span class="math inline">\(x, y, A\)</span> ，我们有 <span class="math display">\[(x + A)(y + A) = A^2 + (x + y)A + xy\]</span></p>
<p>那么当从 <span class="math inline">\(f_i\)</span> 递推到 <span class="math inline">\(f_{i + 1}\)</span> 时，我们需要加上 <span class="math inline">\(2^i - 1\)</span> 个 <span class="math inline">\(A^2\)</span> ， <span class="math inline">\(g_i\)</span> 乘上 <span class="math inline">\(A\)</span> ，以及 <span class="math inline">\(f_i\)</span> 。 <span class="math inline">\(A\)</span> 有两种取值，一种是 <span class="math inline">\(4 * 10^i\)</span> ，一种是 <span class="math inline">\(7 * 10^i\)</span> 。最后再考虑一下多出来的一个积即可。</p>
<p><span class="math inline">\(g\)</span> 的类似。</p>
<p>求出 <span class="math inline">\(f\)</span> 和 <span class="math inline">\(g\)</span> 后，剩下的就简单了。从前往后扫，每遇到一个 7 就计算对答案的贡献。</p>
<h1 id="situation">situation</h1>
<p>今天真心不顺。</p>
<p>先是卡 A 卡了 12 min 。我想写贪心，但是各种怕特判，于是决定写搜。但是搜的一个地方忘记特判导致挂了……</p>
<p>看了 B 后觉得蛮简单的，写完后 A 掉。</p>
<p>看 C 。感觉这个题应该蛮简单的，但是没灵感，遂决定放到一边去。</p>
<p>看了 D 后第一想法是点分治。后面一项分什么治啊，直接 dfs 不就好了吗。我分了好几种情况，交了后发现 WA 了。怒决定写拍。发现拍比正解还难写啊。写完后发现我少考虑了几种情况。经过情况的合并后发现就两种情况嘛。和暴力拍了 20 以内的无误后交了。</p>
<p>然后转过去看 C 。第一想法是一位一位的来，然后就突然想到配对了。 <span class="math inline">\(2^i\)</span> 显然是和 <span class="math inline">\(2^i - 1\)</span> 配对嘛。按照这个思路下去就想到了那个构造，于是就好了。</p>
<p>现在大概还剩 50min 。发现 E 有人过我就去看了一下 E 。看完后瞬间就有想法了，于是推了一下公式后发现是可做的，怒写数位 dp 。写着写着发现只有 10+ min 了，我还没开始调试呢。最后在 1：58 的时候交了一个上去，过了 pretest ，对不对只能听天由命了。</p>
<p>结果 AE FST 了。如果任意一个都没 FST 的话应该可以红的。幸亏过了 D 。不然后果不堪设想呢。</p>
<p>最后 #39 被 liouzhou_101 怒踩。按照这 FST 率下去我真就只能专业算法三十年了。要搞 ACM 的话就找一个代码能力强的吧。</p>
<h1 id="others">others</h1>
<p>wjmsbmr 直接 #1 ，好强大……（现在 wjmsbmr 已经超过我大号了）</p>
<p>liouzhou_101 #38 。</p>
<p>只要 E FST 的人都没有好下场。</p>
<p>感觉第一题蛮好 cha 的。只可惜我没时间了。</p>
<p>感觉今天的 ABC 是主流吧。 squarefk、vfleaking、flydutchman、秋锅都是前三题，只不过速度差异有点大。</p>
<p>大叔只过了前两题，顺利跌回 div2 。</p>
<h1 id="nonsense">nonsense</h1>
<p>今天腾讯打电话过来说进了区域赛了，到时候可以去免费深圳玩玩～</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/03/31/TCO-2A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/03/31/TCO-2A/" itemprop="url">Topcoder-OpenTopcoder-Round2A</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-03-31T12:00:00+08:00">
                2013-03-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Topcoder/" itemprop="url" rel="index">
                    <span itemprop="name">Topcoder</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/03/31/TCO-2A/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/03/31/TCO-2A/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本来就只打算拿件 T-shirt 的。600 挂了就挂了吧。</p>
<p>或许按照这个趋势下去，我有淡出 ACM 届的趋势？还是专注算法三十年好了。</p>
<h1 id="solution">solution</h1>
<h2 id="section">300</h2>
<p>裸贪是不对的。</p>
<p>于是写 dp 吧。 <span class="math inline">\(f_{i, j}\)</span> 表示前 <span class="math inline">\(i\)</span> 个字母中，保留 <span class="math inline">\(j\)</span> 个字母所组成的最优的 S 串，以及在 S 串最优的前提下最优的 T 串。转移枚举这个字母取不取就好了。</p>
<p><span style="color: black">开黑什么的，还是不要搞的为好。</span></p>
<h2 id="section-1">600</h2>
<p>考场上写了个莫名其妙的搜索，当然是 FST 的命运。</p>
<p>考后想高斯消元应该可做啊，于是随手写了个高斯消元。连样例都没调，连我自己都觉得这是错的，结果发现居然过了？我勒个去。</p>
<p>首先特殊情况是 <span class="math inline">\(n &gt; m\)</span> 其中 <span class="math inline">\(m\)</span> 表示有多少个已确定的元素。在这种情况下，一定存在一行一列使得这一行一列上没有已确定元素。于是除这一行一列外的其余的元素随便填，到最后还剩下这一行一列的时候，再枚举每行每列的和是多少，那么每个元素的值都会确定，并且一定存在一组可行解（显然），所以答案就是 <span class="math inline">\(10^{n^2 - 2n + 2 - m}\)</span></p>
<p><span class="math inline">\(n \leq m\)</span> 时的情况比较难处理。不过说到高斯消元大家应该就知道这题该怎么做了。为了解决 10 不是质数，我们利用 CRT 分解下就好。一行一列相等，这个可以表示成一个方程。一个变量的值确定了，我们也可以把它表示成一个方程组。那么共有 <span class="math inline">\(n^2\)</span> 个未知数，有 <span class="math inline">\(n^2 + m\)</span> 个方程。去掉其中线性相关的方程后，答案就是模的自由元次方。再判判无解什么的就好。</p>
<h2 id="section-2">1000</h2>
<p>看完题的第一眼觉得这是水题。仔细想想后发现不会做。经过文学巨匠 wzy 教导后觉得这题怎么还是水题，写完后发现这想法是错的，重新想发现是神题，写了好久总是过不了，调啊调调啊调调了一下午终于发现错误了—— LCM 要用 long long 存……我的天啊</p>
<p>看完题的第一想法是对每个不同的基分开统计。于是我们要求当 <span class="math inline">\(x\)</span> 从 1 取到 <span class="math inline">\(A\)</span> ， <span class="math inline">\(y\)</span> 从 1 取到 <span class="math inline">\(B\)</span> 时，共有多少个不同的 <span class="math inline">\(xy\)</span> 。其中 <span class="math inline">\(A\)</span> 的范围很小，只有 30 。 <span class="math inline">\(B\)</span> 的范围是 <span class="math inline">\(10^9\)</span> 。</p>
<p>文学巨匠的方法如下：对于一个 <span class="math inline">\(x\)</span> ，它最小的质因子为 <span class="math inline">\(d\)</span> ，则 <span class="math inline">\(x\)</span> 对答案作出的贡献是 <span class="math inline">\(xB - \frac{xB}{d}\)</span> 。加起来就好。显然这是错的可是我居然没发现。</p>
<p>考虑容斥。暴力 <span class="math inline">\(2^A\)</span> 的容斥显然是不行的。于是考虑将若干个类似的状态一起表示出来。假设一个数 <span class="math inline">\(n\)</span> 可以同时被表示成若干个 <span class="math inline">\(xy\)</span> ，则 <span class="math inline">\(n\)</span> 一定是所有 <span class="math inline">\(x\)</span> 的公倍数。于是我们可以设计一个 dp ： <span class="math inline">\(f_{i, j, k}\)</span> 表示前 <span class="math inline">\(i\)</span> 个数中，我们选取了 <span class="math inline">\(j\)</span> 个数，这 <span class="math inline">\(j\)</span> 个数的 LCM 为 <span class="math inline">\(k\)</span> 的方案数。 <span class="math inline">\(f\)</span> 的转移很简单，枚举这个数字选不选就好了。由于 <span class="math inline">\(n\)</span> 要能被表示出来的话，一定有 <span class="math inline">\(\frac{n}{\min \{x\}} \leq B\)</span> ，于是我们可以从大往小 dp ，每选中一个数，那么它一定是已选中的数中最小的，在这个时候计算方案数即可。</p>
<p>一个小小的优化是对于只包含前若干个质数的数用 dp ，其余的数仍然爆搜。</p>
<p>然后就可以过了。</p>
<h1 id="situation">situation</h1>
<p>开了 300 后感觉这是个水题啊，于是 YY 了个贪心，大概就是把上下的绑在一起，用一个栈处理一下。但是这样做是过不了样例的。瞬间想起了 dp 。然后就只有 260+ 分了。看起来样例蛮有良心的。</p>
<p><code>penicillo</code> 你 299.80 分是什么心态。</p>
<p>然后开 600 。看完后第一想法是 <span class="math inline">\(n\)</span> 大的话很好处理， <span class="math inline">\(n\)</span> 小就不好搞了。于是我决定写搜。我的方法是找一个空格子，使得这个空格子所在的十字内的已选格子尽量少。然后爆搜出一个小矩形的，这个矩形的大小具体有多大我也不知道 = =|| ，但是肯定很小就是了。对于其余的格子，我猜解的数目等于 10 的自由元次方，但是这是错的 T_T 于是光荣 FST 了。</p>
<p>写了正解后发现正解比爆搜还好写些，什么心态。</p>
<p>1000 看完题目就溜了。</p>
<p>最后过了 300 #90 。由于是小号所以仍然可以涨 LOL 。</p>
<h1 id="others">others</h1>
<p>各种奇葩不忍直视。</p>
<p>tourist 前两题都好慢的说，但是靠 cha 人 cha 到了 #3 真是不忍直视……</p>
<p>有人只交了第一题 FST 后仍然有 300 分，丧心病狂。</p>
<p>wuzhengkai 被我怒压 0.03 分……</p>
<p>大部分人是过了第一题，scottai #205 edly #209 xujie #350</p>
<p>target 君 tomek 居然 #375 ，只交了 140+ 分然后怒 cha 错三个。</p>
<p>lyrically 被 cha * 1 FST * 1 最后靠 cha 人没爆零。</p>
<p>cgy4ever FST * 1 加上 cha 错一个导致爆负，太可怕了。</p>
<p>大叔又一次爆零了……但是令人惊悚是……他……居然……涨了……</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/03/30/test-tex/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/03/30/test-tex/" itemprop="url">Test-TeX</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-03-30T12:00:00+08:00">
                2013-03-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/03/30/test-tex/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/03/30/test-tex/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>纯粹试试 TeX 的。</p>
<p>不知道 github 支不支持 blahtex 诶。</p>
<p>传说中的行内公式 <span class="math inline">\(O(\sqrt{n} \log n \frac{n}{m})\)</span> 。再来一个？ <span class="math inline">\(O(n \sqrt{n})\)</span> 。</p>
<p>传说中的行间公式： <span class="math display">\[f(n) = \sum_{i = 1}^n i\]</span></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="roosephu.github.io/2013/03/30/TeX-support/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuping Luo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AFAIK">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/03/30/TeX-support/" itemprop="url">TeX-support</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-03-30T12:00:00+08:00">
                2013-03-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/03/30/TeX-support/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2013/03/30/TeX-support/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>没 TeX 心里痒痒的，用的真心不方便。其实用 TeX 的一大理由就是它的公式。显示的很漂亮。偏偏干这一行的公式比较多，特别是在复杂度那一块，没哪些题是不需要涉及到复杂度的。于是痛下决心看能不能支持 TeX 呢？首先可以用 MathJax 。但是 MathJax 太慢了，而且占网速，总之我不喜欢……</p>
<p>于是搜索一堆东西，首先对 <code>Pandoc</code> 有期望，然后发现不会用。后来在本地看到一个叫做 <code>Marutex</code> 的东西。 <code>Maruku</code> 是 jekyll 用的 markdown 渲染器。Marutex 会不会支持 TeX 呢？让我们拭目以待。</p>
<p>事实证明，在 blahtex 的帮助下，Maruku 是可以支持 TeX 公式的。 Blahtex 是一个转换器，调用了系统的 TeX 解析器，利用 dvips 转成 png。初看起来效果确实是不错。由于 png 支持透明，公式就像是普通文字，这点尤其舒服。</p>
<p>但是，很囧的一点，blahtex 生成的图片背景透明，文字是黑色的，而我 blog 背景默认也是暗色调的，因此公式看不太清，这点特别囧。于是我们有两种解决方案： 1. 换一个 blog 主题 2. 改动 png</p>
<p>由于这个主题是我比较满意的，特别是背景我特别喜欢（我个人比较喜欢这个风格的画），所以决定使用第二种方案，改动 png 。</p>
<p>由于最终免不了调用 TeX 的解析器，所以我们可以直接在 TeX 源文件上做文章。我的第一想法是用 color 函数，直接把字体颜色改成白色。看了 help 后发现可以直接用命令行参数来设置。由于我不知道 Maruku 在哪里设置 blahtex 的参数，于是我决定自己写个程序来实现。这就不免涉及到外部程序的调用。</p>
<p>据我所知，一个程序调用了外部程序，则被调用的程序的 stdin、stdout、stderr 均会继承父程序的。可是我写了程序后发现明明 stdin 被继承了，可是仍然输入不进。一个不到 1K 只有 20- 行的程序我看了好久硬是没看到哪里有问题。最后发现， <code>execve</code> 的第二个参数这个数组的第一个元素必须和第一个参数一样……浪费了好多时间囧……</p>
<p>中间有个插曲，某一次我在生成 png 的过程中，只生成了一个 hash 用的 txt ，png 没有生成。结果下次启动 jekyll 的时候总是报错，我一个一个包的排查最后发现把某个临时文件夹清空就好了。</p>
<p>好的，现在可以调用外部程序了。可是字体颜色怎么还是黑色呢？经过不断努力地尝试，我发现了原因： blahtex 会使用一个叫做 preview 的包。这个包会覆盖 color 函数所设置的颜色。于是我干脆就不使用 preview 这个包了。发现 jekyll 不断报错，实在没办法了我就只好去看 Maruku 调用 blahtex 的实现。又参考了一堆的 help ，原因是： blahtex 需要 preview 这个包才能提供生成的 png 文件的尺寸，而 Maruku 需要 blahtex 提供尺寸来进行 png 的缩放。</p>
<p>然后我又蛋疼的去查如何获取一个 png 的尺寸。又准备写程序了 = =||</p>
<p>最后实在无聊，我把直接修改 html ，把 html 代码中和 png 大小相关的东西全部删掉，发现 png 能够正常显示。那就这样吧。于是最后我决定直接把 Maruku 中所有和 png 大小相关的代码直接删掉。似乎终于可以了？看一下效果。</p>
<h1 id="效果">效果</h1>
<p>这是传说中的行内公式： <span class="math inline">\(O(n \log n + n \sqrt{n})\)</span> ……应该没大 bug 吧。再看看所谓的行间公式：</p>
<p><span class="math display">\[1 + 2 + \dots + n = \frac{1}{2} n(n + 1)\]</span></p>
<p>好吧就这样吧。</p>
<h1 id="eggache">eggache</h1>
<p>蛋疼是没有上限的。我又遇到了一个问题，github 仓库显然没有 blahtex ，如何在访问 github 的时候能看到这些图片呢？</p>
<p>于是最蛋疼的事是：我不得不新建一个 repo ，用来保存 blog 的源代码，然后原来的 repo 只存放生成的 html 以及图片。也就是说原来是 github 渲染 html ，现在是我上传 html 及其相关文档上去，github 只负责显示了。所以每次更新文章很蛋疼的：</p>
<pre><code>git add *
git commit -m &quot;xx&quot;
git push origin master
jekyll --no-auto ../roosephu.github.com
cd ../roosephu.github.com
git add *
git commit -m &quot;xx&quot;
git push origin master</code></pre>
<p>不过有了 TeX 的支持还是很不错的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Yuping Luo</p>
              <p class="site-description motion-element" itemprop="description">Valar Morghulis</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">117</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://www.google.com/+YupingLuo" target="_blank" title="Google+">
                      
                        <i class="fa fa-fw fa-globe"></i>Google+</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/roosephu" target="_blank" title="Github">
                      
                        <i class="fa fa-fw fa-globe"></i>Github</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/yuping.luo.96" target="_blank" title="Facebook">
                      
                        <i class="fa fa-fw fa-globe"></i>Facebook</a>
                  </span>
                
            </div>
          

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
                <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
              </a>
            </div>
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuping Luo</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  

    
      <script id="dsq-count-scr" src="https://roosephus-blog.disqus.com/count.js" async></script>
    

    

  

















  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
